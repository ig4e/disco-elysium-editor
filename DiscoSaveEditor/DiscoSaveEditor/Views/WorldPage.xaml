<Page
    x:Class="DiscoSaveEditor.Views.WorldPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:DiscoSaveEditor.ViewModels">

    <ScrollViewer>
        <StackPanel Padding="24" Spacing="24" MaxWidth="1100">

            <TextBlock Text="World &amp; Variables" Style="{StaticResource TitleTextBlockStyle}" />

            <!-- Reputation / Political Alignment -->
            <TextBlock Text="Political Alignment &amp; Reputation" Style="{StaticResource SubtitleTextBlockStyle}" />
            <Grid ColumnSpacing="16" RowSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <StackPanel Grid.Column="0" Grid.Row="0">
                    <TextBlock Text="Communist" Style="{StaticResource CaptionTextBlockStyle}" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <NumberBox Value="{x:Bind ViewModel.ReputationCommunist, Mode=TwoWay}" 
                               SpinButtonPlacementMode="Compact" SmallChange="1" LargeChange="5" />
                </StackPanel>
                <StackPanel Grid.Column="1" Grid.Row="0">
                    <TextBlock Text="Ultraliberal" Style="{StaticResource CaptionTextBlockStyle}" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <NumberBox Value="{x:Bind ViewModel.ReputationUltraliberal, Mode=TwoWay}" 
                               SpinButtonPlacementMode="Compact" SmallChange="1" LargeChange="5" />
                </StackPanel>
                <StackPanel Grid.Column="2" Grid.Row="0">
                    <TextBlock Text="Moralist" Style="{StaticResource CaptionTextBlockStyle}" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <NumberBox Value="{x:Bind ViewModel.ReputationMoralist, Mode=TwoWay}" 
                               SpinButtonPlacementMode="Compact" SmallChange="1" LargeChange="5" />
                </StackPanel>
                <StackPanel Grid.Column="0" Grid.Row="1">
                    <TextBlock Text="Nationalist" Style="{StaticResource CaptionTextBlockStyle}" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <NumberBox Value="{x:Bind ViewModel.ReputationNationalist, Mode=TwoWay}" 
                               SpinButtonPlacementMode="Compact" SmallChange="1" LargeChange="5" />
                </StackPanel>
                <StackPanel Grid.Column="1" Grid.Row="1">
                    <TextBlock Text="Kim Relationship" Style="{StaticResource CaptionTextBlockStyle}" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <NumberBox Value="{x:Bind ViewModel.ReputationKim, Mode=TwoWay}" 
                               SpinButtonPlacementMode="Compact" SmallChange="1" LargeChange="5" />
                </StackPanel>
                <StackPanel Grid.Column="2" Grid.Row="1">
                    <TextBlock Text="Weather Preset" Style="{StaticResource CaptionTextBlockStyle}" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <NumberBox Value="{x:Bind ViewModel.WeatherPreset, Mode=TwoWay}" 
                               Minimum="0" Maximum="4" SpinButtonPlacementMode="Compact" />
                </StackPanel>
            </Grid>

            <!-- Fog of War + Variable search -->
            <TextBlock Text="Lua Variables" Style="{StaticResource SubtitleTextBlockStyle}" Margin="0,8,0,0" />
            <StackPanel Orientation="Horizontal" Spacing="20">
                <TextBox Text="{x:Bind ViewModel.SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                         PlaceholderText="Search variables..." Width="300" Header="Filter Variables"/>
                <ToggleSwitch IsOn="{x:Bind ViewModel.IsFogOfWarEnabled, Mode=TwoWay}" 
                              Header="Fog of War" OffContent="Disabled (Revealed)" OnContent="Enabled"/>
                <TextBlock VerticalAlignment="Bottom" Margin="0,0,0,8" FontSize="12"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                    <Run Text="Showing " />
                    <Run Text="{x:Bind ViewModel.Variables.Count, Mode=OneWay}" />
                    <Run Text=" of " />
                    <Run Text="{x:Bind ViewModel.TotalVariableCount, Mode=OneWay}" />
                    <Run Text=" variables" />
                </TextBlock>
            </StackPanel>

            <ListView ItemsSource="{x:Bind ViewModel.Variables}"
                      SelectionMode="None" MaxHeight="600">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="vm:VariableDisplayItem">
                        <Grid ColumnDefinitions="*,100,200" Padding="8,4">
                            <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="0,0,12,0">
                                <TextBlock Text="{x:Bind Key}" FontWeight="Bold" FontSize="12" />
                                <TextBlock Text="{x:Bind Description}" Style="{StaticResource CaptionTextBlockStyle}" 
                                           Foreground="{ThemeResource TextFillColorTertiaryBrush}" 
                                           TextTrimming="CharacterEllipsis" MaxLines="1" />
                            </StackPanel>
                            
                            <TextBlock Grid.Column="1" Text="{x:Bind Type}" VerticalAlignment="Center" 
                                       FontSize="11" Foreground="{ThemeResource TextFillColorTertiaryBrush}"/>

                            <TextBox Grid.Column="2" Text="{x:Bind Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                     VerticalAlignment="Center"/>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </StackPanel>
    </ScrollViewer>
</Page>
