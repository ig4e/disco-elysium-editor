<Page
    x:Class="DiscoSaveEditor.Views.WhiteChecksPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:DiscoSaveEditor.ViewModels">

    <Grid Padding="32,24,32,32" RowSpacing="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" ColumnSpacing="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0">
                <TextBlock Text="Failed White Checks" Style="{StaticResource TitleTextBlockStyle}" />
                <TextBlock FontSize="12" Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                    <Run Text="Reset failed passive checks to retry them. " />
                    <Run Text="{x:Bind ViewModel.TotalFailed, Mode=OneWay}" />
                    <Run Text=" failed checks found." />
                </TextBlock>
            </StackPanel>
            <Button Grid.Column="1" Content="Reset All Failed" 
                    Command="{x:Bind ViewModel.ResetAllFailedCommand}" VerticalAlignment="Center" />
            <Button Grid.Column="2" Content="Clear Marks" 
                    Command="{x:Bind ViewModel.ClearResetMarksCommand}" VerticalAlignment="Center" />
        </Grid>

        <AutoSuggestBox Grid.Row="1" PlaceholderText="Search checks..." QueryIcon="Find"
                         Text="{x:Bind ViewModel.SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

        <Pivot Grid.Row="2">
            <PivotItem Header="Failed Checks">
                <ListView ItemsSource="{x:Bind ViewModel.FailedChecks}" SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="vm:WhiteCheckDisplayItem">
                            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    BorderThickness="1" CornerRadius="4" Padding="12,8" Margin="0,2">
                                <Grid ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="160" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="{x:Bind FlagName}" FontWeight="SemiBold" TextWrapping="Wrap" />
                                        <TextBlock Text="{x:Bind CheckPrecondition}" FontSize="10"
                                                   Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                                                   MaxLines="1" TextTrimming="CharacterEllipsis" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <TextBlock Text="{x:Bind SkillDisplayName}" FontWeight="SemiBold" FontSize="12" />
                                        <TextBlock Text="{x:Bind SkillType}" FontSize="10"
                                                   Foreground="{ThemeResource TextFillColorTertiaryBrush}" />
                                    </StackPanel>

                                    <TextBlock Grid.Column="2" Text="{x:Bind DifficultyText}" FontSize="12"
                                               VerticalAlignment="Center"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />

                                    <CheckBox Grid.Column="3" Content="Reset" 
                                              IsChecked="{x:Bind MarkedForReset, Mode=TwoWay}"
                                              VerticalAlignment="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </PivotItem>

            <PivotItem Header="Seen Checks">
                <ListView ItemsSource="{x:Bind ViewModel.SeenChecks}" SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="vm:WhiteCheckDisplayItem">
                            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    BorderThickness="1" CornerRadius="4" Padding="12,8" Margin="0,2">
                                <Grid ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="160" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="{x:Bind FlagName}" FontWeight="SemiBold" TextWrapping="Wrap" />
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="{x:Bind SkillDisplayName}" FontSize="12"
                                               VerticalAlignment="Center" />

                                    <TextBlock Grid.Column="2" Text="{x:Bind DifficultyText}" FontSize="12"
                                               VerticalAlignment="Center"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />

                                    <CheckBox Grid.Column="3" Content="Reset" 
                                              IsChecked="{x:Bind MarkedForReset, Mode=TwoWay}"
                                              VerticalAlignment="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </PivotItem>
        </Pivot>
    </Grid>
</Page>
